<div class="container mt-5">
  <h2>Listado de Asistencias</h2>
  <!-- Secci칩n de Filtros -->
  <div class="mb-3">
    <form [formGroup]="filtroForm">
      <div class="row align-items-center">
        <!-- Filtro por Fecha -->
        <div class="col">
          <label for="fecha" class="col-form-label">Fecha:</label>
          <input type="month" id="fecha" class="form-control" formControlName="fecha">
        </div>
        <!-- Filtro por Trabajador -->
        <div class="col">
          <label for="trabajador" class="col-form-label">Trabajador:</label>
          <select id="trabajador" class="form-select" formControlName="trabajador">
            <option value="" disabled>Seleccionar trabajador</option>
            <option *ngFor="let trabajador of trabajadores" [ngValue]="trabajador.nombre">{{ trabajador.nombre }}</option>
          </select>
        </div>        
        <!-- Bot칩n de A침adir Asistencia Mensual -->
        <div class="col text-end">
          <button class="btn btn-success" routerLink="/crear-asistencia">A침adir asistencia mensual</button>
        </div>
      </div>
    </form>
  </div>
  
    <!-- Tabla de Asistencias -->
    <div class="table-responsive">
      <table class="table table-striped">
        <thead>
          <tr>
            <th>#</th>
            <th>Trabajador</th>
            <th>Fecha</th>
            <th>Hora de Entrada</th>
            <th>Hora de Salida</th>
            <th>Hora de Entrada Real</th>
            <th>Hora de Salida Real</th>
            <th>Diferencia (minutos)</th>
            <th>Total Horas</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let asistencia of asistenciasFiltradas; let i = index">
            <td>{{ i + 1 }}</td>
            <td>
              <ng-container *ngIf="esObjetoTrabajador(asistencia.trabajador); else nombreString">
                {{ asistencia.trabajador.nombre }}
              </ng-container>
              <ng-template #nombreString>{{ asistencia.trabajador }}</ng-template>
            </td>              
            <td>{{ dateFormatService.formatDate(asistencia.dia) }}</td>
            <td>
              <select class="form-control" [(ngModel)]="asistencia.horaEntrada" (change)="cambiarHorarioEntrada(asistencia._id!, asistencia.horaEntrada!)">
                <option value="" disabled selected>Cambiar Horario de Entrada</option>
                <option value="00:00">0:00</option>
                <option value="00:15">0:15</option>
                <option value="00:30">0:30</option>
                <option value="00:45">0:45</option>
                <option value="01:00">1:00</option>
                <option value="01:15">1:15</option>
                <option value="01:30">1:30</option>
                <option value="01:45">1:45</option>
                <option value="02:00">2:00</option>
                <option value="02:15">2:15</option>
                <option value="02:30">2:30</option>
                <option value="02:45">2:45</option>
                <option value="03:00">3:00</option>
                <option value="03:15">3:15</option>
                <option value="03:30">3:30</option>
                <option value="03:45">3:45</option>
                <option value="04:00">4:00</option>
                <option value="04:15">4:15</option>
                <option value="04:30">4:30</option>
                <option value="04:45">4:45</option>
                <option value="05:00">5:00</option>
                <option value="05:15">5:15</option>
                <option value="05:30">5:30</option>
                <option value="05:45">5:45</option>
                <option value="06:00">6:00</option>
                <option value="06:15">6:15</option>
                <option value="06:30">6:30</option>
                <option value="06:45">6:45</option>
                <option value="07:00">7:00</option>
                <option value="07:15">7:15</option>
                <option value="07:30">7:30</option>
                <option value="07:45">7:45</option>
                <option value="08:00">8:00</option>
                <option value="08:15">8:15</option>
                <option value="08:30">8:30</option>
                <option value="08:45">8:45</option>
                <option value="09:00">9:00</option>
                <option value="09:15">9:15</option>
                <option value="09:30">9:30</option>
                <option value="09:45">9:45</option>
                <option value="10:00">10:00</option>
                <option value="10:15">10:15</option>
                <option value="10:30">10:30</option>
                <option value="10:45">10:45</option>
                <option value="11:00">11:00</option>
                <option value="11:15">11:15</option>
                <option value="11:30">11:30</option>
                <option value="11:45">11:45</option>
                <option value="12:00">12:00</option>
                <option value="12:15">12:15</option>
                <option value="12:30">12:30</option>
                <option value="12:45">12:45</option>
                <option value="13:00">13:00</option>
                <option value="13:15">13:15</option>
                <option value="13:30">13:30</option>
                <option value="13:45">13:45</option>
                <option value="14:00">14:00</option>
                <option value="14:15">14:15</option>
                <option value="14:30">14:30</option>
                <option value="14:45">14:45</option>
                <option value="15:00">15:00</option>
                <option value="15:15">15:15</option>
                <option value="15:30">15:30</option>
                <option value="15:45">15:45</option>
                <option value="16:00">16:00</option>
                <option value="16:15">16:15</option>
                <option value="16:30">16:30</option>
                <option value="16:45">16:45</option>
                <option value="17:00">17:00</option>
                <option value="17:15">17:15</option>
                <option value="17:30">17:30</option>
                <option value="17:45">17:45</option>
                <option value="18:00">18:00</option>
                <option value="18:15">18:15</option>
                <option value="18:30">18:30</option>
                <option value="18:45">18:45</option>
                <option value="19:00">19:00</option>
                <option value="19:15">19:15</option>
                <option value="19:30">19:30</option>
                <option value="19:45">19:45</option>
                <option value="20:00">20:00</option>
                <option value="20:15">20:15</option>
                <option value="20:30">20:30</option>
                <option value="20:45">20:45</option>
                <option value="21:00">21:00</option>
                <option value="21:15">21:15</option>
                <option value="21:30">21:30</option>
                <option value="21:45">21:45</option>
                <option value="22:00">22:00</option>
                <option value="22:15">22:15</option>
                <option value="22:30">22:30</option>
                <option value="22:45">22:45</option>
                <option value="23:00">23:00</option>
                <option value="23:15">23:15</option>
                <option value="23:30">23:30</option>
                <option value="23:45">23:45</option>
              </select>
            </td>
            <td>
              <select class="form-control" [(ngModel)]="asistencia.horaSalida" (change)="cambiarHorarioSalida(asistencia._id!, asistencia.horaSalida!)">
                <option value="" disabled selected>Cambiar Horario de Salida</option>
                <option value="00:00">0:00</option>
                <option value="00:15">0:15</option>
                <option value="00:30">0:30</option>
                <option value="00:45">0:45</option>
                <option value="01:00">1:00</option>
                <option value="01:15">1:15</option>
                <option value="01:30">1:30</option>
                <option value="01:45">1:45</option>
                <option value="02:00">2:00</option>
                <option value="02:15">2:15</option>
                <option value="02:30">2:30</option>
                <option value="02:45">2:45</option>
                <option value="03:00">3:00</option>
                <option value="03:15">3:15</option>
                <option value="03:30">3:30</option>
                <option value="03:45">3:45</option>
                <option value="04:00">4:00</option>
                <option value="04:15">4:15</option>
                <option value="04:30">4:30</option>
                <option value="04:45">4:45</option>
                <option value="05:00">5:00</option>
                <option value="05:15">5:15</option>
                <option value="05:30">5:30</option>
                <option value="05:45">5:45</option>
                <option value="06:00">6:00</option>
                <option value="06:15">6:15</option>
                <option value="06:30">6:30</option>
                <option value="06:45">6:45</option>
                <option value="07:00">7:00</option>
                <option value="07:15">7:15</option>
                <option value="07:30">7:30</option>
                <option value="07:45">7:45</option>
                <option value="08:00">8:00</option>
                <option value="08:15">8:15</option>
                <option value="08:30">8:30</option>
                <option value="08:45">8:45</option>
                <option value="09:00">9:00</option>
                <option value="09:15">9:15</option>
                <option value="09:30">9:30</option>
                <option value="09:45">9:45</option>
                <option value="10:00">10:00</option>
                <option value="10:15">10:15</option>
                <option value="10:30">10:30</option>
                <option value="10:45">10:45</option>
                <option value="11:00">11:00</option>
                <option value="11:15">11:15</option>
                <option value="11:30">11:30</option>
                <option value="11:45">11:45</option>
                <option value="12:00">12:00</option>
                <option value="12:15">12:15</option>
                <option value="12:30">12:30</option>
                <option value="12:45">12:45</option>
                <option value="13:00">13:00</option>
                <option value="13:15">13:15</option>
                <option value="13:30">13:30</option>
                <option value="13:45">13:45</option>
                <option value="14:00">14:00</option>
                <option value="14:15">14:15</option>
                <option value="14:30">14:30</option>
                <option value="14:45">14:45</option>
                <option value="15:00">15:00</option>
                <option value="15:15">15:15</option>
                <option value="15:30">15:30</option>
                <option value="15:45">15:45</option>
                <option value="16:00">16:00</option>
                <option value="16:15">16:15</option>
                <option value="16:30">16:30</option>
                <option value="16:45">16:45</option>
                <option value="17:00">17:00</option>
                <option value="17:15">17:15</option>
                <option value="17:30">17:30</option>
                <option value="17:45">17:45</option>
                <option value="18:00">18:00</option>
                <option value="18:15">18:15</option>
                <option value="18:30">18:30</option>
                <option value="18:45">18:45</option>
                <option value="19:00">19:00</option>
                <option value="19:15">19:15</option>
                <option value="19:30">19:30</option>
                <option value="19:45">19:45</option>
                <option value="20:00">20:00</option>
                <option value="20:15">20:15</option>
                <option value="20:30">20:30</option>
                <option value="20:45">20:45</option>
                <option value="21:00">21:00</option>
                <option value="21:15">21:15</option>
                <option value="21:30">21:30</option>
                <option value="21:45">21:45</option>
                <option value="22:00">22:00</option>
                <option value="22:15">22:15</option>
                <option value="22:30">22:30</option>
                <option value="22:45">22:45</option>
                <option value="23:00">23:00</option>
                <option value="23:15">23:15</option>
                <option value="23:30">23:30</option>
                <option value="23:45">23:45</option>
              </select>
            </td>
            <td>{{ asistencia.entradaReal }}</td>
            <td>{{ asistencia.salidaReal }}</td>
            <td>{{ calcularDiferencia(asistencia) }}</td>
            <td>{{ asistencia.horasTotales }}</td>
            <td>
            </td>
          </tr>
        </tbody>        
        
      </table>
    </div>
</div>

<div class="col-md-4 text-end">
  <button class="btn btn-primary btn-volver" routerLink="/recursos-humanos">Volver</button>
</div>